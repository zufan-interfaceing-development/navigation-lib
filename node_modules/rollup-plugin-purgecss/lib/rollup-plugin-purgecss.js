"use strict";var e=require("fs"),t=require("purgecss"),u=require("rollup-pluginutils");function r(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=r(e);module.exports=function(e){const r=u.createFilter(e.include||["**/*.css"],e.exclude||"node_modules/**"),s=[];let i="";return{name:"purgecss",transform:async(u,n)=>{if(!r(n))return null;let i=(await(new t.PurgeCSS).purge({content:e.content,css:[{raw:u}]}))[0].css;return s.push(i),i=JSON.stringify(i),e.insert||(u=e.output?'"";':i),{code:`export default ${u}`,map:{mappings:""}}},generateBundle(){if(!(e.insert||s.length&&!1!==e.output))return;const t=s.reduce(((e,t)=>e+t),"");return"string"==typeof e.output?n.default.writeFileSync(e.output,t):"function"==typeof e.output?e.output(t,s):!e.insert&&i?((i.endsWith(".js")||i.endsWith(".ts"))&&(i=i.slice(0,-3)),i=`${i}.css`,n.default.writeFileSync(i,t)):void 0}}};
